// SPDX-License-Identifier: GPL-2.0
//
// Copyright (c) 2020 MediaTek Inc.
// Author: Weiyi Lu <weiyi.lu@mediatek.com>

#include <linux/clk-provider.h>
#include <linux/io.h>
#include <linux/seq_file.h>

#include "clkdbg.h"

#define DUMP_INIT_STATE		0

/*
 * clkdbg dump_regs
 */

enum {
	mcucfg,
	topckgen,
	infracfg_ao,
	scpsys,
	apmixedsys,
	infracfg_ao_bcrm,
	nnasys,
	scp_adsp,
	audsys,
	audsys_src,
	pericfg_ao,
	imp_iic_wrap_s,
	imp_iic_wrap_w,
	mfgcfg,
	vppsys0,
	wpesys,
	wpesys_vpp0,
	wpesys_vpp1,
	vppsys1,
	imgsys,
	imgsys1_dip_top,
	imgsys1_dip_nr,
	imgsys1_wpe,
	ipesys,
	camsys,
	camsys_rawa,
	camsys_yuva,
	camsys_rawb,
	camsys_yuvb,
	camsys_mraw,
	ccusys,
	vdecsys_soc,
	vdecsys,
	vdecsys_core1,
	apusys_pll,
	vencsys,
	vencsys_core1,
	vdosys0,
	vdosys1,
};

#define REGBASE_V(_phys, _id_name) { .phys = _phys, .name = #_id_name }

/*
 * checkpatch.pl ERROR:COMPLEX_MACRO
 *
 * #define REGBASE(_phys, _id_name) [_id_name] = REGBASE_V(_phys, _id_name)
 */

static struct regbase rb[] = {
	[mcucfg] = REGBASE_V(0x0C53A000, mcucfg),	/* PAGE_SIZE: 0x0C530000 -> 0x0C53A000 */
	[topckgen] = REGBASE_V(0x10000000, topckgen),
	[infracfg_ao] = REGBASE_V(0x10001000, infracfg_ao),
	[scpsys] = REGBASE_V(0x10006000, scpsys),
	[apmixedsys] = REGBASE_V(0x1000C000, apmixedsys),
	[infracfg_ao_bcrm] = REGBASE_V(0x10022000, infracfg_ao_bcrm),
	[nnasys] = REGBASE_V(0x10211000, nnasys),
	[scp_adsp] = REGBASE_V(0x10720000, scp_adsp),
	[audsys] = REGBASE_V(0x10890000, audsys),
	[audsys_src] = REGBASE_V(0x108a1000, audsys_src), /* PAGE_SIZE: 0x108a0000 -> 0x108a1000 */
	[pericfg_ao] = REGBASE_V(0x11003000, pericfg_ao),
	[imp_iic_wrap_s] = REGBASE_V(0x11D03000, imp_iic_wrap_s),
	[imp_iic_wrap_w] = REGBASE_V(0x11E05000, imp_iic_wrap_w),
	[mfgcfg] = REGBASE_V(0x13fbf000, mfgcfg),
	[vppsys0] = REGBASE_V(0x14000000, vppsys0),
	[wpesys] = REGBASE_V(0x14e00000, wpesys),
	[wpesys_vpp0] = REGBASE_V(0x14e02000, wpesys_vpp0),
	[wpesys_vpp1] = REGBASE_V(0x14e03000, wpesys_vpp1),
	[vppsys1] = REGBASE_V(0x14f00000, vppsys1),
	[imgsys] = REGBASE_V(0x15000000, imgsys),
	[imgsys1_dip_top] = REGBASE_V(0x15110000, imgsys1_dip_top),
	[imgsys1_dip_nr] = REGBASE_V(0x15130000, imgsys1_dip_nr),
	[imgsys1_wpe] = REGBASE_V(0x15220000, imgsys1_wpe),
	[ipesys] = REGBASE_V(0x15330000, ipesys),
	[camsys] = REGBASE_V(0x16000000, camsys),
	[camsys_rawa] = REGBASE_V(0x1604f000, camsys_rawa),
	[camsys_yuva] = REGBASE_V(0x1606f000, camsys_yuva),
	[camsys_rawb] = REGBASE_V(0x1608f000, camsys_rawb),
	[camsys_yuvb] = REGBASE_V(0x160af000, camsys_yuvb),
	[camsys_mraw] = REGBASE_V(0x16140000, camsys_mraw),
	[ccusys] = REGBASE_V(0x17200000, ccusys),
	[vdecsys_soc] = REGBASE_V(0x1800f000, vdecsys_soc),
	[vdecsys] = REGBASE_V(0x1802f000, vdecsys),
	[vdecsys_core1] = REGBASE_V(0x1803f000, vdecsys_core1),
	[apusys_pll] = REGBASE_V(0x190F3000, apusys_pll),
	[vencsys] = REGBASE_V(0x1a000000, vencsys),
	[vencsys_core1] = REGBASE_V(0x1b000000, vencsys_core1),
	[vdosys0] = REGBASE_V(0x1c01a000, vdosys0),
	[vdosys1] = REGBASE_V(0x1c100000, vdosys1),
};

#define REGNAME(_base, _ofs, _name)	\
	{ .base = &rb[_base], .ofs = _ofs, .name = #_name }

static struct regname rn[] = {
	REGNAME(apmixedsys, 0x0000, AP_PLL_CON0),
	REGNAME(apmixedsys, 0x0020, ARMPLL_LL_CON0),
	REGNAME(apmixedsys, 0x0024, ARMPLL_LL_CON1),
	REGNAME(apmixedsys, 0x0028, ARMPLL_LL_CON2),
	REGNAME(apmixedsys, 0x002C, ARMPLL_LL_CON3),
	REGNAME(apmixedsys, 0X0600, ARMPLL_LL_CON4),
	REGNAME(apmixedsys, 0X0070, ARMPLL_BL_CON0),
	REGNAME(apmixedsys, 0X0074, ARMPLL_BL_CON1),
	REGNAME(apmixedsys, 0X0078, ARMPLL_BL_CON2),
	REGNAME(apmixedsys, 0X007C, ARMPLL_BL_CON3),
	REGNAME(apmixedsys, 0X0080, ARMPLL_BL_CON4),
	REGNAME(apmixedsys, 0X0030, CCIPLL_CON0),
	REGNAME(apmixedsys, 0X0634, CCIPLL_CON1),
	REGNAME(apmixedsys, 0X0638, CCIPLL_CON2),
	REGNAME(apmixedsys, 0X063C, CCIPLL_CON3),
	REGNAME(apmixedsys, 0X0640, CCIPLL_CON4),
	REGNAME(apmixedsys, 0X0390, NNAPLL_CON0),
	REGNAME(apmixedsys, 0X0394, NNAPLL_CON1),
	REGNAME(apmixedsys, 0X0398, NNAPLL_CON2),
	REGNAME(apmixedsys, 0X039C, NNAPLL_CON3),
	REGNAME(apmixedsys, 0X03A0, NNAPLL_CON4),
	REGNAME(apmixedsys, 0X0190, RESPLL_CON0),
	REGNAME(apmixedsys, 0X0194, RESPLL_CON1),
	REGNAME(apmixedsys, 0X0198, RESPLL_CON2),
	REGNAME(apmixedsys, 0X019C, RESPLL_CON3),
	REGNAME(apmixedsys, 0X0320, RESPLL_CON4),
	REGNAME(apmixedsys, 0X0360, ETHPLL_CON0),
	REGNAME(apmixedsys, 0X0364, ETHPLL_CON1),
	REGNAME(apmixedsys, 0X0368, ETHPLL_CON2),
	REGNAME(apmixedsys, 0X036C, ETHPLL_CON3),
	REGNAME(apmixedsys, 0X0370, ETHPLL_CON4),
	REGNAME(apmixedsys, 0X0710, MSDCPLL_CON0),
	REGNAME(apmixedsys, 0X0714, MSDCPLL_CON1),
	REGNAME(apmixedsys, 0X0718, MSDCPLL_CON2),
	REGNAME(apmixedsys, 0X071C, MSDCPLL_CON3),
	REGNAME(apmixedsys, 0X0720, MSDCPLL_CON4),
	REGNAME(apmixedsys, 0X00A0, TVDPLL1_CON0),
	REGNAME(apmixedsys, 0X00A4, TVDPLL1_CON1),
	REGNAME(apmixedsys, 0X00A8, TVDPLL1_CON2),
	REGNAME(apmixedsys, 0X00AC, TVDPLL1_CON3),
	REGNAME(apmixedsys, 0X00B0, TVDPLL1_CON4),
	REGNAME(apmixedsys, 0X00C0, TVDPLL2_CON0),
	REGNAME(apmixedsys, 0X00C4, TVDPLL2_CON1),
	REGNAME(apmixedsys, 0X00C8, TVDPLL2_CON2),
	REGNAME(apmixedsys, 0X00CC, TVDPLL2_CON3),
	REGNAME(apmixedsys, 0X00D0, TVDPLL2_CON4),
	REGNAME(apmixedsys, 0X0800, MPLL_CON0),
	REGNAME(apmixedsys, 0X0804, MPLL_CON1),
	REGNAME(apmixedsys, 0X0808, MPLL_CON2),
	REGNAME(apmixedsys, 0X080C, MPLL_CON3),
	REGNAME(apmixedsys, 0X0810, MPLL_CON4),
	REGNAME(apmixedsys, 0X00E0, MMPLL_CON0),
	REGNAME(apmixedsys, 0X00E4, MMPLL_CON1),
	REGNAME(apmixedsys, 0X00E8, MMPLL_CON2),
	REGNAME(apmixedsys, 0X00EC, MMPLL_CON3),
	REGNAME(apmixedsys, 0X00F0, MMPLL_CON4),
	REGNAME(apmixedsys, 0X01D0, MAINPLL_CON0),
	REGNAME(apmixedsys, 0X01D4, MAINPLL_CON1),
	REGNAME(apmixedsys, 0X01D8, MAINPLL_CON2),
	REGNAME(apmixedsys, 0X01DC, MAINPLL_CON3),
	REGNAME(apmixedsys, 0X01E0, MAINPLL_CON4),
	REGNAME(apmixedsys, 0X0890, VDECPLL_CON0),
	REGNAME(apmixedsys, 0X0894, VDECPLL_CON1),
	REGNAME(apmixedsys, 0X0898, VDECPLL_CON2),
	REGNAME(apmixedsys, 0X089C, VDECPLL_CON3),
	REGNAME(apmixedsys, 0X08A0, VDECPLL_CON4),
	REGNAME(apmixedsys, 0X0100, IMGPLL_CON0),
	REGNAME(apmixedsys, 0X0104, IMGPLL_CON1),
	REGNAME(apmixedsys, 0X0108, IMGPLL_CON2),
	REGNAME(apmixedsys, 0X010C, IMGPLL_CON3),
	REGNAME(apmixedsys, 0X0110, IMGPLL_CON4),
	REGNAME(apmixedsys, 0X01F0, UNIVPLL_CON0),
	REGNAME(apmixedsys, 0X01F4, UNIVPLL_CON1),
	REGNAME(apmixedsys, 0X01F8, UNIVPLL_CON2),
	REGNAME(apmixedsys, 0X01FC, UNIVPLL_CON3),
	REGNAME(apmixedsys, 0X0700, UNIVPLL_CON4),
	REGNAME(apmixedsys, 0X08C0, HDMIPLL1_CON0),
	REGNAME(apmixedsys, 0X08C4, HDMIPLL1_CON1),
	REGNAME(apmixedsys, 0X08C8, HDMIPLL1_CON2),
	REGNAME(apmixedsys, 0X08CC, HDMIPLL1_CON3),
	REGNAME(apmixedsys, 0X08D0, HDMIPLL1_CON4),
	REGNAME(apmixedsys, 0X0870, HDMIPLL2_CON0),
	REGNAME(apmixedsys, 0X0874, HDMIPLL2_CON1),
	REGNAME(apmixedsys, 0X0878, HDMIPLL2_CON2),
	REGNAME(apmixedsys, 0X087C, HDMIPLL2_CON3),
	REGNAME(apmixedsys, 0X0880, HDMIPLL2_CON4),
	REGNAME(apmixedsys, 0X08E0, HDMIRX_APLL_CON0),
	REGNAME(apmixedsys, 0X08E4, HDMIRX_APLL_CON1),
	REGNAME(apmixedsys, 0X08E8, HDMIRX_APLL_CON2),
	REGNAME(apmixedsys, 0X08EC, HDMIRX_APLL_CON3),
	REGNAME(apmixedsys, 0X08F0, HDMIRX_APLL_CON4),
	REGNAME(apmixedsys, 0X0DD4, HDMIRX_APLL_CON5),
	REGNAME(apmixedsys, 0X01A0, USB1PLL_CON0),
	REGNAME(apmixedsys, 0X01A4, USB1PLL_CON1),
	REGNAME(apmixedsys, 0X01A8, USB1PLL_CON2),
	REGNAME(apmixedsys, 0X01AC, USB1PLL_CON3),
	REGNAME(apmixedsys, 0X01B0, USB1PLL_CON4),
	REGNAME(apmixedsys, 0X07E0, ADSPPLL_CON0),
	REGNAME(apmixedsys, 0X07E4, ADSPPLL_CON1),
	REGNAME(apmixedsys, 0X07E8, ADSPPLL_CON2),
	REGNAME(apmixedsys, 0X07EC, ADSPPLL_CON3),
	REGNAME(apmixedsys, 0X07F0, ADSPPLL_CON4),
	REGNAME(apmixedsys, 0X07C0, APLL1_CON0),
	REGNAME(apmixedsys, 0X07C4, APLL1_CON1),
	REGNAME(apmixedsys, 0X07C8, APLL1_CON2),
	REGNAME(apmixedsys, 0X07CC, APLL1_CON3),
	REGNAME(apmixedsys, 0X07D0, APLL1_CON4),
	REGNAME(apmixedsys, 0X0DC0, APLL1_CON5),
	REGNAME(apmixedsys, 0X0780, APLL2_CON0),
	REGNAME(apmixedsys, 0X0784, APLL2_CON1),
	REGNAME(apmixedsys, 0X0788, APLL2_CON2),
	REGNAME(apmixedsys, 0X078C, APLL2_CON3),
	REGNAME(apmixedsys, 0X0790, APLL2_CON4),
	REGNAME(apmixedsys, 0X0DC4, APLL2_CON5),
	REGNAME(apmixedsys, 0X0760, APLL3_CON0),
	REGNAME(apmixedsys, 0X0764, APLL3_CON1),
	REGNAME(apmixedsys, 0X0768, APLL3_CON2),
	REGNAME(apmixedsys, 0X076C, APLL3_CON3),
	REGNAME(apmixedsys, 0X0770, APLL3_CON4),
	REGNAME(apmixedsys, 0X0DC8, APLL3_CON5),
	REGNAME(apmixedsys, 0X0740, APLL4_CON0),
	REGNAME(apmixedsys, 0X0744, APLL4_CON1),
	REGNAME(apmixedsys, 0X0748, APLL4_CON2),
	REGNAME(apmixedsys, 0X074C, APLL4_CON3),
	REGNAME(apmixedsys, 0X0750, APLL4_CON4),
	REGNAME(apmixedsys, 0X0DCC, APLL4_CON5),
	REGNAME(apmixedsys, 0X07A0, APLL5_CON0),
	REGNAME(apmixedsys, 0X07A4, APLL5_CON1),
	REGNAME(apmixedsys, 0X07A8, APLL5_CON2),
	REGNAME(apmixedsys, 0X07AC, APLL5_CON3),
	REGNAME(apmixedsys, 0X07B0, APLL5_CON4),
	REGNAME(apmixedsys, 0X0DD0, APLL5_CON5),
	REGNAME(apmixedsys, 0X0340, MFGPLL_CON0),
	REGNAME(apmixedsys, 0X0344, MFGPLL_CON1),
	REGNAME(apmixedsys, 0X0348, MFGPLL_CON2),
	REGNAME(apmixedsys, 0X034C, MFGPLL_CON3),
	REGNAME(apmixedsys, 0X0350, MFGPLL_CON4),
	REGNAME(apmixedsys, 0X0150, DGIPLL_CON0),
	REGNAME(apmixedsys, 0X0154, DGIPLL_CON1),
	REGNAME(apmixedsys, 0X0158, DGIPLL_CON2),
	REGNAME(apmixedsys, 0X015C, DGIPLL_CON3),
	REGNAME(apmixedsys, 0X0160, DGIPLL_CON4),
	REGNAME(apmixedsys, 0x0470, APLL1_TUNER_CON0),
	REGNAME(apmixedsys, 0x0474, APLL2_TUNER_CON0),
	REGNAME(apmixedsys, 0x0478, APLL3_TUNER_CON0),
	REGNAME(apmixedsys, 0x047C, APLL4_TUNER_CON0),
	REGNAME(apmixedsys, 0x0480, APLL5_TUNER_CON0),
	REGNAME(apusys_pll, 0x008, PLL4H_PLL1_CON0),
	REGNAME(apusys_pll, 0x00C, PLL4H_PLL1_CON1),
	REGNAME(apusys_pll, 0x014, PLL4H_PLL1_CON3),
	REGNAME(apusys_pll, 0x018, PLL4H_PLL2_CON0),
	REGNAME(apusys_pll, 0x01C, PLL4H_PLL2_CON1),
	REGNAME(apusys_pll, 0x024, PLL4H_PLL2_CON3),
	REGNAME(apusys_pll, 0x028, PLL4H_PLL3_CON0),
	REGNAME(apusys_pll, 0x02C, PLL4H_PLL3_CON1),
	REGNAME(apusys_pll, 0x034, PLL4H_PLL3_CON3),
	REGNAME(apusys_pll, 0x038, PLL4H_PLL4_CON0),
	REGNAME(apusys_pll, 0x03C, PLL4H_PLL4_CON1),
	REGNAME(apusys_pll, 0x044, PLL4H_PLL4_CON3),
	REGNAME(mcucfg, 0x02A0, CPU_PLLDIV_CFG0),	/* PAGE_SIZE: 0xA2A0->0x02A0 */
	REGNAME(mcucfg, 0x02A4, CPU_PLLDIV_CFG1),	/* PAGE_SIZE: 0xA2A4->0x02A4 */
	REGNAME(mcucfg, 0x02E0, BUS_PLLDIV_CFG),	/* PAGE_SIZE: 0xA2E0->0x02E0 */
	REGNAME(infracfg_ao, 0x70, INFRA_BUS_DCM_CTRL),
	REGNAME(infracfg_ao_bcrm, 0x034, VDNR_DCM_TOP_INFRA_CTRL0),
	REGNAME(topckgen, 0x0264, CLK_SCP_CFG_0),
	REGNAME(topckgen, 0x020, CLK_CFG_0),
	REGNAME(topckgen, 0x02c, CLK_CFG_1),
	REGNAME(topckgen, 0x038, CLK_CFG_2),
	REGNAME(topckgen, 0x044, CLK_CFG_3),
	REGNAME(topckgen, 0x050, CLK_CFG_4),
	REGNAME(topckgen, 0x05c, CLK_CFG_5),
	REGNAME(topckgen, 0x068, CLK_CFG_6),
	REGNAME(topckgen, 0x074, CLK_CFG_7),
	REGNAME(topckgen, 0x080, CLK_CFG_8),
	REGNAME(topckgen, 0x08c, CLK_CFG_9),
	REGNAME(topckgen, 0x098, CLK_CFG_10),
	REGNAME(topckgen, 0x0a4, CLK_CFG_11),
	REGNAME(topckgen, 0x0b0, CLK_CFG_12),
	REGNAME(topckgen, 0x0bc, CLK_CFG_13),
	REGNAME(topckgen, 0x0c8, CLK_CFG_14),
	REGNAME(topckgen, 0x0d4, CLK_CFG_15),
	REGNAME(topckgen, 0x0e0, CLK_CFG_16),
	REGNAME(topckgen, 0x0ec, CLK_CFG_17),
	REGNAME(topckgen, 0x0f8, CLK_CFG_18),
	REGNAME(topckgen, 0x104, CLK_CFG_19),
	REGNAME(topckgen, 0x110, CLK_CFG_20),
	REGNAME(topckgen, 0x11c, CLK_CFG_21),
	REGNAME(topckgen, 0x128, CLK_CFG_22),
	REGNAME(topckgen, 0x134, CLK_CFG_23),
	REGNAME(topckgen, 0x140, CLK_CFG_24),
	REGNAME(topckgen, 0x14c, CLK_CFG_25),
	REGNAME(topckgen, 0x158, CLK_CFG_26),
	REGNAME(topckgen, 0x164, CLK_CFG_27),
	REGNAME(topckgen, 0x170, CLK_CFG_28),
	REGNAME(topckgen, 0x17c, CLK_CFG_29),
	REGNAME(topckgen, 0x1dc, CLK_CFG_37),
	REGNAME(scpsys, 0x16C, PWR_STATUS),
	REGNAME(scpsys, 0x170, PWR_STATUS_2ND),
	REGNAME(scpsys, 0x174, CPU_PWR_STATUS),
	REGNAME(scpsys, 0x178, CPU_PWR_STATUS_2ND),
	REGNAME(scpsys, 0x300, MFG0_PWR_CON),
	REGNAME(scpsys, 0x304, MFG1_PWR_CON),
	REGNAME(scpsys, 0x308, MFG2_PWR_CON),
	REGNAME(scpsys, 0x30C, MFG3_PWR_CON),
	REGNAME(scpsys, 0x310, MFG4_PWR_CON),
	REGNAME(scpsys, 0x314, MFG5_PWR_CON),
	REGNAME(scpsys, 0x318, MFG6_PWR_CON),
	REGNAME(scpsys, 0x328, PEXTP_MAC_TOP_P0_PWR_CON),
	REGNAME(scpsys, 0x32C, PEXTP_MAC_TOP_P1_PWR_CON),
	REGNAME(scpsys, 0x330, PCIE_PHY_PWR_CON),
	REGNAME(scpsys, 0x334, SSUSB_PCIE_PHY_PWR_CON),
	REGNAME(scpsys, 0x338, SSUSB_TOP_P1_PWR_CON),
	REGNAME(scpsys, 0x33C, SSUSB_TOP_P2_PWR_CON),
	REGNAME(scpsys, 0x340, SSUSB_TOP_P3_PWR_CON),
	REGNAME(scpsys, 0x344, ETHER_PWR_CON),
	REGNAME(scpsys, 0x358, AUDIO_PWR_CON),
	REGNAME(scpsys, 0x35C, AUDIO_ASRC_PWR_CON),
	REGNAME(scpsys, 0x360, ADSP_PWR_CON),
	REGNAME(scpsys, 0x364, VPPSYS0_PWR_CON),
	REGNAME(scpsys, 0x368, VPPSYS1_PWR_CON),
	REGNAME(scpsys, 0x36C, VDOSYS0_PWR_CON),
	REGNAME(scpsys, 0x370, VDOSYS1_PWR_CON),
	REGNAME(scpsys, 0x374, WPESYS_PWR_CON),
	REGNAME(scpsys, 0x378, DP_TX_PWR_CON),
	REGNAME(scpsys, 0x37C, EDP_TX_PWR_CON),
	REGNAME(scpsys, 0x380, HDMI_TX_PWR_CON),
	REGNAME(scpsys, 0x384, HDMI_RX_PWR_CON),
	REGNAME(scpsys, 0x388, VDE0_PWR_CON),
	REGNAME(scpsys, 0x38C, VDE1_PWR_CON),
	REGNAME(scpsys, 0x390, VDE2_PWR_CON),
	REGNAME(scpsys, 0x394, VEN_PWR_CON),
	REGNAME(scpsys, 0x398, VEN_CORE1_PWR_CON),
	REGNAME(scpsys, 0x39C, CAM_PWR_CON),
	REGNAME(scpsys, 0x3A0, CAM_RAWA_PWR_CON),
	REGNAME(scpsys, 0x3A4, CAM_RAWB_PWR_CON),
	REGNAME(scpsys, 0x3A8, CAM_RAWC_PWR_CON),
	REGNAME(scpsys, 0x3AC, IMG_M_PWR_CON),
	REGNAME(scpsys, 0x3B0, IMG_D_PWR_CON),
	REGNAME(scpsys, 0x3B4, IPE_PWR_CON),
	REGNAME(scpsys, 0x3B8, NNA0_PWR_CON),
	REGNAME(scpsys, 0x3BC, NNA1_PWR_CON),
	REGNAME(scpsys, 0x3C0, IPNNA_PWR_CON),
	REGNAME(scpsys, 0x3C4, CSI_RX_TOP_PWR_CON),
	REGNAME(topckgen, 0x238, TOPCKGEN_CLK_MISC_CFG_1),
	REGNAME(topckgen, 0x250, TOPCKGEN_CLK_MISC_CFG_3),
	REGNAME(infracfg_ao, 0x90, INFRACFG_AO_MODULE_SW_CG_0),
	REGNAME(infracfg_ao, 0x94, INFRACFG_AO_MODULE_SW_CG_1),
	REGNAME(infracfg_ao, 0xac, INFRACFG_AO_MODULE_SW_CG_2),
	REGNAME(infracfg_ao, 0xc8, INFRACFG_AO_MODULE_SW_CG_3),
	REGNAME(infracfg_ao, 0xe8, INFRACFG_AO_MODULE_SW_CG_4),
	REGNAME(apmixedsys, 0x8, APMIXEDSYS_AP_PLL_CON2),
	REGNAME(nnasys, 0x104, IPNNA_F26M_CK_CG),
	REGNAME(nnasys, 0x110, IPNNA_AXI_CK_CG),
	REGNAME(nnasys, 0x90, IPNNA_NNA0_CG_EN),
	REGNAME(nnasys, 0x94, IPNNA_NNA1_CG_EN),
	REGNAME(nnasys, 0x98, IPNNA_NNA0_EMI_CG_EN),
	REGNAME(nnasys, 0x9c, IPNNA_NNA1_EMI_CG_EN),
	REGNAME(nnasys, 0xa0, IPNNA_NNA0_AXI_CG_EN),
	REGNAME(nnasys, 0xa4, IPNNA_NNA1_AXI_CG_EN),
	REGNAME(scp_adsp, 0x180, SCP_PAR_TOP_AUDIODSP_CK_CG),
	REGNAME(audsys, 0x0, AUDIO_AUDIO_TOP_0),
	REGNAME(audsys, 0x10, AUDIO_AUDIO_TOP_4),
	REGNAME(audsys, 0x14, AUDIO_AUDIO_TOP_5),
	REGNAME(audsys, 0x18, AUDIO_AUDIO_TOP_6),
	REGNAME(audsys, 0x4, AUDIO_AUDIO_TOP_1),
	REGNAME(audsys, 0xc, AUDIO_AUDIO_TOP_3),
	REGNAME(audsys_src, 0x0004, AUDIO_SRC_MEM_ASRC_TOP_1),	/* PAGE_SIZE: 0x1004->0x0004 */
	REGNAME(pericfg_ao, 0x18, PERICFG_AO_PERI_MODULE_SW_CG_0),
	REGNAME(imp_iic_wrap_s, 0xe00, IMP_IIC_WRAP_SOUTH_AP_CLOCK_CG_SOUTH),
	REGNAME(imp_iic_wrap_w, 0xe00, IMP_IIC_WRAP_WEST_AP_CLOCK_CG_WEST),
	REGNAME(mfgcfg, 0x0, MFGCFG_MFG_CG),
	REGNAME(vppsys0, 0x20, VPP0_REG_VPPSYS0_CG0),
	REGNAME(vppsys0, 0x2c, VPP0_REG_VPPSYS0_CG1),
	REGNAME(vppsys0, 0x38, VPP0_REG_VPPSYS0_CG2),
	REGNAME(wpesys, 0x0, WPESYS_TOP_REG_WPESYS_RG_000),
	REGNAME(wpesys_vpp0, 0x58, WPE_VPP0_CTL_WPE_DCM_DIS),
	REGNAME(wpesys_vpp0, 0x5c, WPE_VPP0_CTL_DMA_DCM_DIS),
	REGNAME(wpesys_vpp1, 0x58, WPE_VPP1_CTL_WPE_DCM_DIS),
	REGNAME(wpesys_vpp1, 0x5c, WPE_VPP1_CTL_DMA_DCM_DIS),
	REGNAME(vppsys1, 0x100, VPPSYS1_CONFIG_VPPSYS1_CG_0),
	REGNAME(vppsys1, 0x110, VPPSYS1_CONFIG_VPPSYS1_CG_1),
	REGNAME(imgsys, 0x0, IMGSYS_MAIN_IMG_MAIN_CG),
	REGNAME(imgsys1_dip_top, 0x0, IMGSYS1_DIP_TOP_MACRO_CG),
	REGNAME(imgsys1_dip_nr, 0x0, IMGSYS1_DIP_NR_MACRO_CG),
	REGNAME(imgsys1_wpe, 0x0, IMGSYS1_WPE_MACRO_CG),
	REGNAME(ipesys, 0x0, IPESYS_MACRO_CG),
	REGNAME(camsys, 0x0, CAMSYS_MAIN_CAMSYS_CG),
	REGNAME(camsys_rawa, 0x0, CAMSYS_RAWA_CAMSYS_CG),
	REGNAME(camsys_yuva, 0x0, CAMSYS_YUVA_CAMSYS_CG),
	REGNAME(camsys_rawb, 0x0, CAMSYS_RAWB_CAMSYS_CG),
	REGNAME(camsys_yuvb, 0x0, CAMSYS_YUVB_CAMSYS_CG),
	REGNAME(camsys_mraw, 0x0, CAMSYS_MRAW_CAMSYS_CG),
	REGNAME(ccusys, 0x0, CCU_MAIN_CCUSYS_CG),
	REGNAME(vdecsys_soc, 0x0, VDEC_SOC_GCON_VDEC_CKEN),
	REGNAME(vdecsys_soc, 0x200, VDEC_SOC_GCON_LAT_CKEN),
	REGNAME(vdecsys_soc, 0x8, VDEC_SOC_GCON_LARB_CKEN_CON),
	REGNAME(vdecsys, 0x0, VDEC_GCON_VDEC_CKEN),
	REGNAME(vdecsys, 0x200, VDEC_GCON_LAT_CKEN),
	REGNAME(vdecsys, 0x8, VDEC_GCON_LARB_CKEN_CON),
	REGNAME(vdecsys_core1, 0x0, VDEC_CORE1_GCON_VDEC_CKEN),
	REGNAME(vdecsys_core1, 0x200, VDEC_CORE1_GCON_LAT_CKEN),
	REGNAME(vdecsys_core1, 0x8, VDEC_CORE1_GCON_LARB_CKEN_CON),
	REGNAME(vencsys, 0x0, VENC_GCON_VENCSYS_CG),
	REGNAME(vencsys_core1, 0x0, VENC_CORE1_GCON_VENCSYS_CG),
	REGNAME(vdosys0, 0x100, VDOSYS0_CONFIG_GLOBAL0_CG_0),
	REGNAME(vdosys0, 0x110, VDOSYS0_CONFIG_GLOBAL0_CG_1),
	REGNAME(vdosys0, 0x120, VDOSYS0_CONFIG_GLOBAL0_CG_2),
	REGNAME(vdosys1, 0x100, VDOSYS1_CONFIG_VDOSYS1_CG_0),
	REGNAME(vdosys1, 0x120, VDOSYS1_CONFIG_VDOSYS1_CG_1),
	REGNAME(vdosys1, 0x130, VDOSYS1_CONFIG_VDOSYS1_CG_2),
	REGNAME(vdosys1, 0x140, VDOSYS1_CONFIG_VDOSYS1_CG_3),
	{}
};

static const struct regname *get_all_regnames(void)
{
	return rn;
}

static void __init init_regbase(void)
{
	size_t i;

	for (i = 0; i < ARRAY_SIZE(rb); i++)
		rb[i].virt = ioremap(rb[i].phys, PAGE_SIZE);
}

/*
 * clkdbg fmeter
 */

#include <linux/delay.h>

#define clk_readl(addr)		readl(addr)
#define clk_writel(addr, val)	\
	do { writel(val, addr); wmb(); } while (0) /* sync write */

#define FMCLK(_t, _i, _n) { .type = _t, .id = _i, .name = _n }

static const struct fmeter_clk fclks[] = {
	FMCLK(ABIST, 1, "AD_ADSPPLL_CK"),
	FMCLK(ABIST, 2, "AD_APLL1_CK"),
	FMCLK(ABIST, 3, "AD_APLL2_CK"),
	FMCLK(ABIST, 4, "AD_APLL3_CK"),
	FMCLK(ABIST, 5, "AD_APLL4_CK"),
	FMCLK(ABIST, 6, "AD_APLL5_CK"),
	FMCLK(ABIST, 7, "AD_DGIPLL_CK"),
	FMCLK(ABIST, 8, "pad_in_dgi_clk_i"),
	FMCLK(ABIST, 9, "AD_HDMIPLL1_CK"),
	FMCLK(ABIST, 10, "AD_HDMIPLL2_CK"),
	FMCLK(ABIST, 11, "AD_HDMIRX_APLL_CK"),
	FMCLK(ABIST, 12, "AD_ETHPLL_CK"),
	FMCLK(ABIST, 13, "AD_IMGPLL_CK"),
	FMCLK(ABIST, 14, "AD_MAINPLL_CK"),
	FMCLK(ABIST, 15, "AD_MAINPLL_DIV2_CK"),
	FMCLK(ABIST, 16, "AD_MAINPLL_DIV3_CK"),
	FMCLK(ABIST, 17, "AD_MAINPLL_DIV4_CK"),
	FMCLK(ABIST, 18, "AD_MAINPLL_DIV5_CK"),
	FMCLK(ABIST, 19, "AD_MAINPLL_DIV6_CK"),
	FMCLK(ABIST, 20, "AD_MAINPLL_DIV7_CK"),
	FMCLK(ABIST, 21, "AD_MAINPLL_DIV9_CK"),
	FMCLK(ABIST, 22, "AD_CLKSQ_FS26M_CK"),
	FMCLK(ABIST, 23, "AD_MMPLL_CK"),
	FMCLK(ABIST, 24, "AD_MMPLL_D3_CK"),
	FMCLK(ABIST, 25, "AD_MMPLL_D4_CK"),
	FMCLK(ABIST, 26, "AD_MMPLL_D5_CK"),
	FMCLK(ABIST, 27, "AD_MMPLL_D6_CK"),
	FMCLK(ABIST, 28, "AD_MMPLL_D7_CK"),
	FMCLK(ABIST, 29, "AD_MMPLL_D9_CK"),
	FMCLK(ABIST, 30, "AD_MPLL_CK"),
	FMCLK(ABIST, 31, "AD_MSDCPLL_CK"),
	FMCLK(ABIST, 32, "AD_MFGPLL_CK"),
	FMCLK(ABIST, 33, "AD_MFGPLL_OPP_CK"),
	FMCLK(ABIST, 34, "AD_TVDPLL1_CK"),
	FMCLK(ABIST, 35, "AD_TVDPLL2_CK"),
	FMCLK(ABIST, 36, "AD_CLKSQ_CKBUF1_26M"),
	FMCLK(ABIST, 37, "AD_CLKSQ_CKBUF2_26M"),
	FMCLK(ABIST, 38, "AD_UNIVPLL_CK"),
	FMCLK(ABIST, 39, "AD_UNIVPLL_DIV2_CK"),
	FMCLK(ABIST, 40, "AD_UNIVPLL_DIV3_CK"),
	FMCLK(ABIST, 41, "AD_UNIVPLL_DIV4_CK"),
	FMCLK(ABIST, 42, "AD_UNIVPLL_DIV5_CK"),
	FMCLK(ABIST, 43, "AD_UNIVPLL_DIV6_CK"),
	FMCLK(ABIST, 44, "AD_UNIVPLL_DIV7_CK"),
	FMCLK(ABIST, 45, "AD_USB20_192M_CK"),
	FMCLK(ABIST, 46, "AD_USB1PLL_CK"),
	FMCLK(ABIST, 47, "AD_VDECPLL_CK"),
	FMCLK(ABIST, 48, "AD_ULPOSC_CK"),
	FMCLK(ABIST, 49, "AD_OSC_SYNC_CK"),
	FMCLK(ABIST, 50, "AD_ULPOSC2_CK"),
	FMCLK(ABIST, 51, "AD_OSC_SYNC_CK_2"),
	FMCLK(ABIST, 52, "AD_ARMPLL_LL_CK"),
	FMCLK(ABIST, 53, "AD_ARMPLL_BL_CK"),
	FMCLK(ABIST, 54, "AD_CCIPLL_CK"),
	FMCLK(ABIST, 55, "AD_NNAPLL_CK"),
	FMCLK(ABIST, 56, "AD_RESPLL_CK"),
	FMCLK(ABIST, 57, "AD_APPLLGP1_MON_FM_CK"),
	FMCLK(ABIST, 58, "dsi0_ad_dsi_ckg_dsiclk_anaout"),
	FMCLK(ABIST, 59, "dsi0_ad_dsi_test_ck_anaout"),
	FMCLK(ABIST, 60, "dsi1_ad_dsi_ckg_dsiclk_anaout"),
	FMCLK(ABIST, 61, "dsi1_ad_dsi_test_ck_anaout"),
	FMCLK(ABIST, 62, "_FIXED_0"),
	FMCLK(ABIST, 63, "AD_NNAPLL_CKDIV_CK"),
	FMCLK(ABIST, 64, "ADA_LVTS_TO_PLLGP_MON_CK_L1"),
	FMCLK(ABIST, 65, "ADA_LVTS_TO_PLLGP_MON_CK_L2"),
	FMCLK(ABIST, 66, "ADA_LVTS_TO_PLLGP_MON_CK_L3"),
	FMCLK(ABIST, 67, "ADA_LVTS_TO_PLLGP_MON_CK_L4"),
	FMCLK(ABIST, 68, "ADA_LVTS_TO_PLLGP_MON_CK_L5"),
	FMCLK(ABIST, 69, "ADA_LVTS_TO_PLLGP_MON_CK_L6"),
	FMCLK(ABIST, 70, "ADA_LVTS_TO_PLLGP_MON_CK_L7"),
	FMCLK(ABIST, 71, "AD_CSI0A_CDPHY_DELAYCAL_CK"),
	FMCLK(ABIST, 72, "AD_CSI0B_CDPHY_DELAYCAL_CK"),
	FMCLK(ABIST, 73, "AD_CSI0C_CDPHY_DELAYCAL_CK"),
	FMCLK(ABIST, 74, "AD_CSI0D_CDPHY_DELAYCAL_CK"),
	FMCLK(ABIST, 75, "AD_CSI2A_CDPHY_DELAYCAL_CK"),
	FMCLK(ABIST, 76, "AD_CSI2B_CDPHY_DELAYCAL_CK"),
	FMCLK(ABIST, 77, "eARC_bck_int"),
	FMCLK(ABIST, 78, "mclk_128fs_o"),
	FMCLK(ABIST, 79, "spdifin_iec_ck"),
	FMCLK(ABIST, 80, "other_splin_bck_i"),
	FMCLK(ABIST, 81, "other_splin_mck_i"),
	FMCLK(ABIST, 82, "u2a_rx_sof_p0"),
	FMCLK(ABIST, 83, "u2a_rx_sof_p2"),
	FMCLK(ABIST, 84, "u2a_rx_sof_p3"),
	FMCLK(ABIST, 85, "u2a_tx_sof_p0"),
	FMCLK(ABIST, 86, "u2a_tx_sof_p1"),
	FMCLK(ABIST, 87, "u2a_tx_sof_p2"),
	FMCLK(ABIST, 88, "u2a_tx_sof_p3"),
	FMCLK(ABIST, 89, "aud_i2sin_mck_i"),
	FMCLK(ABIST, 90, "aud_i2sin_bck_i"),
	FMCLK(ABIST, 91, "other_tdmin_mck_i"),
	FMCLK(ABIST, 92, "aud_i2so2_bck_i"),
	FMCLK(ABIST, 93, "aud_i2si4_bck_i"),
	FMCLK(ABIST, 94, "aud_i2si5_bck_i"),
	FMCLK(ABIST, 95, "AD_HDMITX21PLL_MONREF_CK"),
	FMCLK(ABIST, 96, "AD_HDMITX21PLL_MONFBK_CK"),
	FMCLK(ABIST, 97, "AD_HDMITX21_CLKDIG_1"),
	FMCLK(ABIST, 98, "AD_HDMITX21_CLKDIG_1_CTS"),
	FMCLK(ABIST, 99, "AD_HDMITXPLL_PIXEL_CK"),
	FMCLK(ABIST, 100, "AD_EARCRX_DM_CK"),
	FMCLK(ABIST, 101, "AD_EARCRX_CM_SLEW_CK"),
	FMCLK(ABIST, 102, "AD_EARCRXPLL_CK_DIG"),
	FMCLK(ABIST, 103, "msdc01_in_ck"),
	FMCLK(ABIST, 104, "msdc02_in_ck"),
	FMCLK(ABIST, 105, "msdc11_in_ck"),
	FMCLK(ABIST, 106, "msdc12_in_ck"),
	FMCLK(ABIST, 107, "msdc21_in_ck"),
	FMCLK(ABIST, 108, "msdc22_in_ck"),
	FMCLK(ABIST, 109, "msdc31_in_ck"),
	FMCLK(ABIST, 110, "msdc32_in_ck"),
	FMCLK(ABIST, 111, "UFS_MP_CLK2FREQ"),
	FMCLK(ABIST, 112, "mcusys_arm_clk_out_all"),
	FMCLK(ABIST, 113, "fmem_ck_aft_dcm_ch2"),
	FMCLK(ABIST, 114, "fmem_ck_bfe_dcm_ch2"),
	FMCLK(ABIST, 115, "AD_RPHYPLL_DIV4_CK_ch23"),
	FMCLK(ABIST, 116, "AD_RCLRPLL_DIV4_CK_ch23"),
	FMCLK(ABIST, 117, "fmem_ck_aft_dcm_ch0"),
	FMCLK(ABIST, 118, "fmem_ck_bfe_dcm_ch0"),
	FMCLK(ABIST, 119, "AD_RCLRPLL_DIV4_CK_ch01"),
	FMCLK(ABIST, 120, "AD_RPHYPLL_DIV4_CK_ch01"),
	FMCLK(ABIST, 121, "_FIXED_0"),
	FMCLK(ABIST, 122, "_FIXED_0"),
	FMCLK(ABIST, 123, "_FIXED_0"),
	FMCLK(ABIST, 124, "_FIXED_0"),
	FMCLK(ABIST, 125, "_FIXED_0"),
	FMCLK(ABIST, 126, "_FIXED_0"),
	FMCLK(ABIST, 127, "o_rx_acr_aud_clk_x"),
	FMCLK(CKGEN, 0, "hd_faxi_ck"),
	FMCLK(CKGEN, 1, "hg_fspm_ck"),
	FMCLK(CKGEN, 2, "hf_fscp_ck"),
	FMCLK(CKGEN, 3, "hd_fbus_aximem_ck"),
	FMCLK(CKGEN, 4, "hf_fvpp_ck"),
	FMCLK(CKGEN, 5, "hf_fethdr_ck"),
	FMCLK(CKGEN, 6, "hf_fipe_ck"),
	FMCLK(CKGEN, 7, "hf_fcam_ck"),
	FMCLK(CKGEN, 8, "hf_fccu_ck"),
	FMCLK(CKGEN, 9, "hf_fimg_ck"),
	FMCLK(CKGEN, 10, "hf_fcamtm_ck"),
	FMCLK(CKGEN, 11, "hf_fdsp_ck"),
	FMCLK(CKGEN, 12, "hf_fdsp1_ck"),
	FMCLK(CKGEN, 13, "hf_fdsp2_ck"),
	FMCLK(CKGEN, 14, "hf_fdsp3_ck"),
	FMCLK(CKGEN, 15, "hf_fdsp4_ck"),
	FMCLK(CKGEN, 16, "hf_fdsp5_ck"),
	FMCLK(CKGEN, 17, "hf_fdsp6_ck"),
	FMCLK(CKGEN, 18, "hf_fdsp7_ck"),
	FMCLK(CKGEN, 19, "hf_fipu_if_ck"),
	FMCLK(CKGEN, 20, "hf_fmfg_core_tmp_ck"),
	FMCLK(CKGEN, 21, "f_fcamtg_ck"),
	FMCLK(CKGEN, 22, "f_fcamtg2_ck"),
	FMCLK(CKGEN, 23, "f_fcamtg3_ck"),
	FMCLK(CKGEN, 24, "f_fcamtg4_ck"),
	FMCLK(CKGEN, 25, "f_fcamtg5_ck"),
	FMCLK(CKGEN, 26, "f_fuart_ck"),
	FMCLK(CKGEN, 27, "hf_fspi_ck"),
	FMCLK(CKGEN, 28, "hf_fspis_ck"),
	FMCLK(CKGEN, 29, "hf_fmsdc50_0_hclk_ck"),
	FMCLK(CKGEN, 30, "hf_fmsdc50_0_ck"),
	FMCLK(CKGEN, 31, "hf_fmsdc30_1_ck"),
	FMCLK(CKGEN, 32, "hf_fmsdc30_2_ck"),
	FMCLK(CKGEN, 33, "hf_fintdir_ck"),
	FMCLK(CKGEN, 34, "hf_faud_intbus_ck"),
	FMCLK(CKGEN, 35, "hf_faudio_h_ck"),
	FMCLK(CKGEN, 36, "f_fpwrap_ulposc_ck"),
	FMCLK(CKGEN, 37, "hf_fatb_ck"),
	FMCLK(CKGEN, 38, "hf_fpwrmcu_ck"),
	FMCLK(CKGEN, 39, "hf_fdp_ck"),
	FMCLK(CKGEN, 40, "hf_fedp_ck"),
	FMCLK(CKGEN, 41, "hf_fdpi_ck"),
	FMCLK(CKGEN, 42, "f_fdisp_pwm0_ck"),
	FMCLK(CKGEN, 43, "f_fdisp_pwm1_ck"),
	FMCLK(CKGEN, 44, "f_fusb_top_ck"),
	FMCLK(CKGEN, 45, "f_fssusb_xhci_ck"),
	FMCLK(CKGEN, 46, "f_fusb_top_1p_ck"),
	FMCLK(CKGEN, 47, "f_fssusb_xhci_1p_ck"),
	FMCLK(CKGEN, 48, "f_fusb_top_2p_ck"),
	FMCLK(CKGEN, 49, "f_fssusb_xhci_2p_ck"),
	FMCLK(CKGEN, 50, "f_fusb_top_3p_ck"),
	FMCLK(CKGEN, 51, "f_fssusb_xhci_3p_ck"),
	FMCLK(CKGEN, 52, "f_fi2c_ck"),
	FMCLK(CKGEN, 53, "f_fseninf_ck"),
	FMCLK(CKGEN, 54, "f_fseninf1_ck"),
	FMCLK(CKGEN, 55, "f_fseninf2_ck"),
	FMCLK(CKGEN, 56, "f_fseninf3_ck"),
	FMCLK(CKGEN, 57, "hf_gcpu_ck"),
	FMCLK(CKGEN, 58, "hf_fdxcc_ck"),
	FMCLK(CKGEN, 59, "hf_fdpmaif_main_ck"),
	FMCLK(CKGEN, 60, "hf_faes_ufsfde_ck"),
	FMCLK(CKGEN, 61, "hf_fufs_ck"),
	FMCLK(CKGEN, 62, "f_ufs_tick1us_ck"),
	FMCLK(CKGEN, 63, "f_ufs_mp_sap_cfg_ck"),
	FMCLK(CKGEN, 64, "hf_fvenc_ck"),
	FMCLK(CKGEN, 65, "hf_fvdec_ck"),
	FMCLK(CKGEN, 66, "hf_fpwm_ck"),
	FMCLK(CKGEN, 67, "hg_mcupm_ck"),
	FMCLK(CKGEN, 68, "hf_fspmi_p_mst_ck"),
	FMCLK(CKGEN, 69, "hf_fspmi_m_mst_ck"),
	FMCLK(CKGEN, 70, "hg_fdvfsrc_ck"),
	FMCLK(CKGEN, 71, "hf_ftl_ck"),
	FMCLK(CKGEN, 72, "hf_ftl_p1_ck"),
	FMCLK(CKGEN, 73, "hf_faes_msdcfde_ck"),
	FMCLK(CKGEN, 74, "hf_dsi_occ_ck"),
	FMCLK(CKGEN, 75, "hf_fwpe_vpp_ck"),
	FMCLK(CKGEN, 76, "hf_fhdcp_ck"),
	FMCLK(CKGEN, 77, "hf_fhdcp_24m_ck"),
	FMCLK(CKGEN, 78, "hf_fhd20_dacr_ref_clk"),
	FMCLK(CKGEN, 79, "hf_fhd20_hdcp_cclk"),
	FMCLK(CKGEN, 80, "hf_fhdmi_xtal"),
	FMCLK(CKGEN, 81, "hf_fhdmi_apb_ck"),
	FMCLK(CKGEN, 82, "hf_fsnps_eth_250m_ck"),
	FMCLK(CKGEN, 83, "hf_fsnps_eth_62p4m_ptp_ck"),
	FMCLK(CKGEN, 84, "hf_fsnps_eth_50m_rmii_ck"),
	FMCLK(CKGEN, 85, "hf_dgi_out_ck"),
	FMCLK(CKGEN, 86, "hf_ipnna_nna0_ck"),
	FMCLK(CKGEN, 87, "hf_ipnna_nna1_ck"),
	FMCLK(CKGEN, 88, "hf_fadsp_ck"),
	FMCLK(CKGEN, 89, "hf_fasm_h_ck"),
	FMCLK(CKGEN, 90, "hf_fasm_m_ck"),
	FMCLK(CKGEN, 91, "hf_fasm_l_ck"),
	FMCLK(CKGEN, 92, "hf_fapll1_ck"),
	FMCLK(CKGEN, 93, "hf_fapll2_ck"),
	FMCLK(CKGEN, 94, "hf_fapll3_ck"),
	FMCLK(CKGEN, 95, "hf_fapll4_ck"),
	FMCLK(CKGEN, 96, "hf_fapll5_ck"),
	FMCLK(CKGEN, 97, "hf_fi2so1_mck"),
	FMCLK(CKGEN, 98, "hf_fi2so2_mck"),
	FMCLK(CKGEN, 99, "hf_fi2so4_mck"),
	FMCLK(CKGEN, 100, "hf_fi2so5_mck"),
	FMCLK(CKGEN, 101, "hf_fi2si1_mck"),
	FMCLK(CKGEN, 102, "hf_fi2si2_mck"),
	FMCLK(CKGEN, 103, "hf_fi2si4_mck"),
	FMCLK(CKGEN, 104, "hf_fi2si5_mck"),
	FMCLK(CKGEN, 105, "hf_fdptx_mck"),
	FMCLK(CKGEN, 106, "hf_aud_iec_clk"),
	FMCLK(CKGEN, 107, "hf_a1sys_hp_ck"),
	FMCLK(CKGEN, 108, "hf_a2sys_hf_ck"),
	FMCLK(CKGEN, 109, "hf_a3sys_hf_ck"),
	FMCLK(CKGEN, 110, "hf_a4sys_hf_ck"),
	FMCLK(CKGEN, 111, "hf_fspinfi_bclk_ck"),
	FMCLK(CKGEN, 112, "hf_fnfi1x_ck"),
	FMCLK(CKGEN, 113, "hf_ecc_ck"),
	FMCLK(CKGEN, 114, "hf_faudio_local_bus_ck"),
	FMCLK(CKGEN, 115, "hf_fspinor_ck"),
	FMCLK(CKGEN, 116, "f_dvio_dgi_ref_ck"),
	FMCLK(CKGEN, 117, "f_ulposc_ck"),
	FMCLK(CKGEN, 118, "f_ulposc_core_ck"),
	FMCLK(CKGEN, 119, "hf_fsrck_ck"),
	FMCLK(CKGEN, 120, "src_occ_50m_clk"),
	FMCLK(CKGEN, 121, "src_occ_78m_clk"),
	FMCLK(CKGEN, 122, "src_occ_125m_clk"),
	FMCLK(CKGEN, 123, "src_occ_250m_clk"),
	FMCLK(CKGEN, 124, "src_occ_500m_clk"),
	FMCLK(CKGEN, 125, "src_occ_240m_clk"),
	FMCLK(CKGEN, 126, "src_occ_810m_clk"),
	FMCLK(CKGEN, 127, "src_occ_202m_clk"),
	FMCLK(CKGEN, 128, "src_occ_600m_clk"),
	FMCLK(CKGEN, 129, "src_occ_100m_clk"),
	FMCLK(CKGEN, 130, "src_occ_150m_clk"),
	FMCLK(CKGEN, 131, "src_occ_600m_1_clk"),
	FMCLK(CKGEN, 132, "src_occ_208m_clk"),
	FMCLK(CKGEN, 133, "src_occ_202m_1_clk"),
	FMCLK(CKGEN, 134, "src_occ_148m_clk"),
	FMCLK(CKGEN, 135, "src_occ_156m_clk"),
	FMCLK(CKGEN, 136, "src_occ_312m_clk"),
	FMCLK(CKGEN, 137, "src_occ_594m_clk"),
	FMCLK(CKGEN, 138, "src_occ_313m_clk"),
	FMCLK(CKGEN, 139, "src_occ_108m_clk"),
	FMCLK(CKGEN, 140, "src_occ_300m_clk"),
	FMCLK(CKGEN, 141, "src_occ_375m_clk"),
	FMCLK(CKGEN, 142, "src_occ_333m_clk"),
	FMCLK(CKGEN, 143, "src_occ_600m_2_clk"),
	FMCLK(CKGEN, 144, "src_occ_660m_clk"),
	FMCLK(CKGEN, 145, "src_occ_750m_clk"),
	FMCLK(CKGEN, 146, "src_occ_864m_clk"),
	FMCLK(CKGEN, 147, "src_occ_gcpu_div2_ck"),
	FMCLK(CKGEN, 148, "f_rsvd1_ck"),
	FMCLK(CKGEN, 149, "f_rsvd2_ck"),
	FMCLK(CKGEN, 150, "f_rsvd3_ck"),
	{}
};

#define CLK_MISC_CFG_0	(rb[topckgen].virt + 0x22C)
#define CLK_DBG_CFG		(rb[topckgen].virt + 0x20C)
#define CLK26CALI_0		(rb[topckgen].virt + 0x218)
#define CLK26CALI_1		(rb[topckgen].virt + 0x21C)

static unsigned int mt_get_ckgen_freq(unsigned int ID)
{
	int output = 0, i = 0;
	unsigned int temp, clk26cali_0, clk_dbg_cfg, clk_misc_cfg_0, clk26cali_1;
	bool timeout = false;

	clk_dbg_cfg = clk_readl(CLK_DBG_CFG);
	clk_writel(CLK_DBG_CFG, (clk_dbg_cfg & 0xFE00FFFC) | (ID << 16) | 0x1 | (0x1 << 24));

	clk_misc_cfg_0 = clk_readl(CLK_MISC_CFG_0);
	clk_writel(CLK_MISC_CFG_0, (clk_misc_cfg_0 & 0x00FFFFFF)); /* divider = 0*/
	clk26cali_0 = clk_readl(CLK26CALI_0);
	clk26cali_1 = clk_readl(CLK26CALI_1);
	clk_writel(CLK26CALI_0, 0x80);
	clk_writel(CLK26CALI_0, 0x90);

	/* wait frequency meter finish */
	while (clk_readl(CLK26CALI_0) & 0x10) {
		udelay(10);
		i++;
		if (i > 10000) {
			timeout = true;
			pr_info("ckgen meter[%d], timeout\n", ID);
			break;
		}
	}

	if (!timeout) {
		temp = clk_readl(CLK26CALI_1) & 0xFFFF;
		output = (temp * 26000) / 1024; /* KHz */
	} else {
		output = 0;
	}

	clk_writel(CLK_DBG_CFG, clk_dbg_cfg);
	clk_writel(CLK_MISC_CFG_0, clk_misc_cfg_0);
	clk_writel(CLK26CALI_0, clk26cali_0);
	clk_writel(CLK26CALI_1, clk26cali_1);

	/* pr_info("ckgen meter[%d] = %d KHz\n", ID, output); */
	return output;
}

static unsigned int mt_get_abist_freq(unsigned int ID)
{
	int output = 0, i = 0;
	unsigned int temp, clk26cali_0, clk_dbg_cfg, clk_misc_cfg_0, clk26cali_1;
	bool timeout = false;

	clk_dbg_cfg = clk_readl(CLK_DBG_CFG);
	clk_writel(CLK_DBG_CFG, (clk_dbg_cfg & 0xFEFF80FC) | (ID << 8));
	clk_misc_cfg_0 = clk_readl(CLK_MISC_CFG_0);
	clk_writel(CLK_MISC_CFG_0, (clk_misc_cfg_0 & 0x00FFFFFF) | (3 << 24)); /* divider = 4 */
	clk26cali_0 = clk_readl(CLK26CALI_0);
	clk26cali_1 = clk_readl(CLK26CALI_1);
	clk_writel(CLK26CALI_0, 0x80);
	clk_writel(CLK26CALI_0, 0x90);

	/* wait frequency meter finish */
	while (clk_readl(CLK26CALI_0) & 0x10) {
		udelay(10);
		i++;
		if (i > 10000) {
			timeout = true;
			pr_info("abist meter[%d], timeout\n", ID);
			break;
		}
	}

	if (!timeout) {
		temp = clk_readl(CLK26CALI_1) & 0xFFFF;
		output = (temp * 26000) / 1024; /* KHz */
	} else {
		output = 0;
	}

	clk_writel(CLK_DBG_CFG, clk_dbg_cfg);
	clk_writel(CLK_MISC_CFG_0, clk_misc_cfg_0);
	clk_writel(CLK26CALI_0, clk26cali_0);
	clk_writel(CLK26CALI_1, clk26cali_1);

	/* pr_info("abist meter[%d] = %d KHz\n", ID, output * 4); */
	return output * 4;
}

static u32 fmeter_freq_op(const struct fmeter_clk *fclk)
{
	if (fclk->type == ABIST)
		return mt_get_abist_freq(fclk->id);
	else if (fclk->type == CKGEN)
		return mt_get_ckgen_freq(fclk->id);
	return 0;
}

static const struct fmeter_clk *get_all_fmeter_clks(void)
{
	return fclks;
}

/*
 * clkdbg dump_state
 */

static const char * const *get_all_clk_names(void)
{
	static const char * const clks[] = {
		"clk26m",
		"clk32k",
		"nnapll",
		"respll",
		"ethpll",
		"msdcpll",
		"tvdpll1",
		"tvdpll2",
		"mmpll",
		"mainpll",
		"vdecpll",
		"imgpll",
		"univpll",
		"hdmipll1",
		"hdmipll2",
		"hdmirx_apll",
		"usb1pll",
		"adsppll",
		"apll1",
		"apll2",
		"apll3",
		"apll4",
		"apll5",
		"mfgpll",
		"dgipll",
		"apusys_pll_apupll",
		"apusys_pll_npupll",
		"apusys_pll_apupll1",
		"apusys_pll_apupll2",
		"pll_ssusb26m",
		"axi_sel",
		"spm_sel",
		"bus_aximem_sel",
		"vpp_sel",
		"ethdr_sel",
		"ipe_sel",
		"cam_sel",
		"ccu_sel",
		"img_sel",
		"camtm_sel",
		"dsp_sel",
		"dsp1_sel",
		"dsp2_sel",
		"dsp3_sel",
		"dsp4_sel",
		"dsp5_sel",
		"dsp6_sel",
		"dsp7_sel",
		"ipu_if_sel",
		"mfg_sel",
		"camtg_sel",
		"camtg2_sel",
		"camtg3_sel",
		"camtg4_sel",
		"camtg5_sel",
		"uart_sel",
		"spi_sel",
		"spis_sel",
		"msdc50_0_h_sel",
		"msdc50_0_sel",
		"msdc30_1_sel",
		"msdc30_2_sel",
		"intdir_sel",
		"aud_intbus_sel",
		"audio_h_sel",
		"pwrap_ulposc_sel",
		"atb_sel",
		"pwrmcu_sel",
		"dp_sel",
		"edp_sel",
		"dpi_sel",
		"disp_pwm0_sel",
		"disp_pwm1_sel",
		"usb_sel",
		"ssusb_xhci_sel",
		"usb_1p_sel",
		"ssusb_xhci_1p_sel",
		"usb_2p_sel",
		"ssusb_xhci_2p_sel",
		"usb_3p_sel",
		"ssusb_xhci_3p_sel",
		"i2c_sel",
		"seninf_sel",
		"seninf1_sel",
		"seninf2_sel",
		"seninf3_sel",
		"gcpu_sel",
		"dxcc_sel",
		"dpmaif_sel",
		"aes_ufsfde_sel",
		"ufs_sel",
		"ufs_tick1us_sel",
		"ufs_mp_sap_sel",
		"venc_sel",
		"vdec_sel",
		"pwm_sel",
		"spmi_p_mst_sel",
		"spmi_m_mst_sel",
		"tl_sel",
		"tl_p1_sel",
		"aes_msdcfde_sel",
		"dsi_occ_sel",
		"wpe_vpp_sel",
		"hdcp_sel",
		"hdcp_24m_sel",
		"hd20_dacr_ref_sel",
		"hd20_hdcp_c_sel",
		"hdmi_xtal_sel",
		"hdmi_apb_sel",
		"snps_eth_250m_sel",
		"snps_eth_62p4m_ptp_sel",
		"snps_eth_50m_rmii_sel",
		"dgi_out_sel",
		"nna0_sel",
		"nna1_sel",
		"adsp_sel",
		"asm_h_sel",
		"asm_m_sel",
		"asm_l_sel",
		"apll1_sel",
		"apll2_sel",
		"apll3_sel",
		"apll4_sel",
		"apll5_sel",
		"i2so1_m_sel",
		"i2so2_m_sel",
		"i2si1_m_sel",
		"i2si2_m_sel",
		"dptx_m_sel",
		"aud_iec_sel",
		"a1sys_hp_sel",
		"a2sys_sel",
		"a3sys_sel",
		"a4sys_sel",
		"spinfi_b_sel",
		"nfi1x_sel",
		"ecc_sel",
		"audio_local_bus_sel",
		"spinor_sel",
		"dvio_dgi_ref_sel",
		"srck_sel",
		"rsvd1_sel",
		"mfg_fast_sel",
		"clk26m_d2",
		"clk26m_d52",
		"in_dgi",
		"in_dgi_d2",
		"in_dgi_d4",
		"in_dgi_d6",
		"in_dgi_d8",
		"mfgpll_opp",
		"mainpll_ck",
		"mainpll_d3",
		"mainpll_d4",
		"mainpll_d4_d2",
		"mainpll_d4_d4",
		"mainpll_d4_d8",
		"mainpll_d5",
		"mainpll_d5_d2",
		"mainpll_d5_d4",
		"mainpll_d5_d8",
		"mainpll_d6",
		"mainpll_d6_d2",
		"mainpll_d6_d4",
		"mainpll_d6_d8",
		"mainpll_d7",
		"mainpll_d7_d2",
		"mainpll_d7_d4",
		"mainpll_d7_d8",
		"mainpll_d9",
		"univpll_ck",
		"univpll_d2",
		"univpll_d3",
		"univpll_d4",
		"univpll_d4_d2",
		"univpll_d4_d4",
		"univpll_d4_d8",
		"univpll_d5",
		"univpll_d5_d2",
		"univpll_d5_d4",
		"univpll_d5_d8",
		"univpll_d6",
		"univpll_d6_d2",
		"univpll_d6_d4",
		"univpll_d6_d8",
		"univpll_d6_d16",
		"univpll_d7",
		"univpll_192m",
		"univpll_192m_d4",
		"univpll_192m_d8",
		"univpll_192m_d16",
		"univpll_192m_d32",
		"imgpll_ck",
		"apll1_ck",
		"apll1_d3",
		"apll1_d4",
		"apll2_ck",
		"apll2_d3",
		"apll2_d4",
		"apll3_ck",
		"apll3_d4",
		"apll4_ck",
		"apll4_d4",
		"apll5_ck",
		"apll5_d4",
		"hdmirx_apll_ck",
		"hdmirx_apll_d3",
		"hdmirx_apll_d4",
		"hdmirx_apll_d6",
		"nnapll_ck",
		"mmpll_ck",
		"mmpll_d4",
		"mmpll_d4_d2",
		"mmpll_d4_d4",
		"mmpll_d5",
		"mmpll_d5_d2",
		"mmpll_d5_d4",
		"mmpll_d6",
		"mmpll_d6_d2",
		"mmpll_d7",
		"mmpll_d9",
		"tvdpll1_ck",
		"tvdpll1_d2",
		"tvdpll1_d4",
		"tvdpll1_d8",
		"tvdpll1_d16",
		"tvdpll2_ck",
		"tvdpll2_d2",
		"tvdpll2_d4",
		"tvdpll2_d8",
		"tvdpll2_d16",
		"msdcpll_ck",
		"msdcpll_d2",
		"msdcpll_d4",
		"msdcpll_d16",
		"ethpll_ck",
		"ethpll_d2",
		"ethpll_d8",
		"ethpll_d10",
		"dgipll_ck",
		"dgipll_d2",
		"vdecpll_ck",
		"ulposc",
		"ulposc_d2",
		"ulposc_d4",
		"ulposc_d7",
		"ulposc_d8",
		"ulposc_d10",
		"ulposc_d16",
		"ulposc2",
		"adsppll_ck",
		"adsppll_d2",
		"adsppll_d4",
		"adsppll_d8",
		"mem_466m",
		"mphone_slave_b",
		"pextp_pipe",
		"ufs_rx_symbol",
		"ufs_tx_symbol",
		"ssusb_u3phy_p1_p_p0",
		"ufs_rx_symbol1",
		"fpc",
		"hdmirx_p",
		"apll12_div0",
		"apll12_div1",
		"apll12_div2",
		"apll12_div3",
		"apll12_div4",
		"apll12_div9",
		"cfg_vpp0",
		"cfg_vpp1",
		"cfg_vdo0",
		"cfg_vdo1",
		"cfg_unipll_ses",
		"cfg_26m_vpp0",
		"cfg_26m_vpp1",
		"cfg_26m_aud",
		"cfg_axi_east",
		"cfg_axi_east_north",
		"cfg_axi_north",
		"cfg_axi_south",
		"cfg_ext_test",
		"ssusb_ref",
		"ssusb_phy_ref",
		"ssusb_p1_ref",
		"ssusb_phy_p1_ref",
		"ssusb_p2_ref",
		"ssusb_phy_p2_ref",
		"ssusb_p3_ref",
		"ssusb_phy_p3_ref",
		"infra_ao_pmic_tmr",
		"infra_ao_pmic_ap",
		"infra_ao_pmic_md",
		"infra_ao_pmic_conn",
		"infra_ao_sej",
		"infra_ao_apxgpt",
		"infra_ao_gce",
		"infra_ao_gce2",
		"infra_ao_therm",
		"infra_ao_pwm_h",
		"infra_ao_pwm1",
		"infra_ao_pwm2",
		"infra_ao_pwm3",
		"infra_ao_pwm4",
		"infra_ao_pwm",
		"infra_ao_uart0",
		"infra_ao_uart1",
		"infra_ao_uart2",
		"infra_ao_uart3",
		"infra_ao_uart4",
		"infra_ao_gce_26m",
		"infra_ao_cq_dma_fpc",
		"infra_ao_uart5",
		"infra_ao_hdmi_26m",
		"infra_ao_spi0",
		"infra_ao_msdc0",
		"infra_ao_msdc1",
		"infra_ao_cg1_msdc2",
		"infra_ao_msdc0_src",
		"infra_ao_trng",
		"infra_ao_auxadc",
		"infra_ao_cpum",
		"infra_ao_hdmi_32k",
		"infra_ao_cec_66m_h",
		"infra_ao_irrx",
		"infra_ao_pcie_tl_26m",
		"infra_ao_msdc1_src",
		"infra_ao_cec_66m_b",
		"infra_ao_pcie_tl_96m",
		"infra_ao_device_apc",
		"infra_ao_ecc_66m_h",
		"infra_ao_debugsys",
		"infra_ao_audio",
		"infra_ao_pcie_tl_32k",
		"infra_ao_dbg_trace",
		"infra_ao_dramc_f26m",
		"infra_ao_irtx",
		"infra_ao_ssusb",
		"infra_ao_disp_pwm",
		"infra_ao_cldma_b",
		"infra_ao_audio_26m_b",
		"infra_ao_spi1",
		"infra_ao_spi2",
		"infra_ao_spi3",
		"infra_ao_unipro_sys",
		"infra_ao_unipro_tick",
		"infra_ao_ufs_mp_sap_b",
		"infra_ao_pwrmcu",
		"infra_ao_pwrmcu_bus_h",
		"infra_ao_apdma_b",
		"infra_ao_spi4",
		"infra_ao_spi5",
		"infra_ao_cq_dma",
		"infra_ao_aes_ufsfde",
		"infra_ao_aes",
		"infra_ao_ufs_tick",
		"infra_ao_ssusb_xhci",
		"infra_ao_msdc0_self",
		"infra_ao_msdc1_self",
		"infra_ao_msdc2_self",
		"infra_ao_i2s_dma",
		"infra_ao_ap_msdc0",
		"infra_ao_md_msdc0",
		"infra_ao_cg3_msdc2",
		"infra_ao_gcpu",
		"infra_ao_pcie_peri_26m",
		"infra_ao_gcpu_66m_b",
		"infra_ao_gcpu_133m_b",
		"infra_ao_disp_pwm1",
		"infra_ao_fbist2fpc",
		"infra_ao_device_apc_sync",
		"infra_ao_pcie_p1_peri_26m",
		"infra_ao_spis0",
		"infra_ao_spis1",
		"infra_ao_133m_m_peri",
		"infra_ao_66m_m_peri",
		"infra_ao_pcie_pl_p_250m_p0",
		"infra_ao_pcie_pl_p_250m_p1",
		"infra_ao_pcie_p1_tl_96m",
		"infra_ao_aes_msdcfde_0p",
		"infra_ao_ufs_tx_symbol",
		"infra_ao_ufs_rx_symbol",
		"infra_ao_ufs_rx_symbol1",
		"infra_ao_peri_ufs_mem_sub",
		"nna_nna0",
		"nna_nna1",
		"nna_nna0_emi",
		"nna_ckgen_mem",
		"nna_nna1_emi",
		"nna_nna0_axi",
		"nna_nna1_axi",
		"nna_f26m",
		"nna_axi",
		"scp_adsp_audiodsp",
		"aud_afe",
		"aud_lrck_cnt",
		"aud_spdifin_tuner_apll",
		"aud_spdifin_tuner_dbg",
		"aud_ul_tml",
		"aud_apll1_tuner",
		"aud_apll2_tuner",
		"aud_top0_spdf",
		"aud_apll",
		"aud_apll2",
		"aud_dac",
		"aud_dac_predis",
		"aud_tml",
		"aud_adc",
		"aud_dac_hires",
		"aud_a1sys_hp",
		"aud_afe_dmic1",
		"aud_afe_dmic2",
		"aud_afe_dmic3",
		"aud_afe_dmic4",
		"aud_afe_26m_dmic_tm",
		"aud_ul_tml_hires",
		"aud_adc_hires",
		"aud_adda6_adc",
		"aud_adda6_adc_hires",
		"aud_linein_tuner",
		"aud_earc_tuner",
		"aud_i2sin",
		"aud_tdm_in",
		"aud_i2s_out",
		"aud_tdm_out",
		"aud_hdmi_out",
		"aud_asrc11",
		"aud_asrc12",
		"aud_multi_in",
		"aud_intdir",
		"aud_a1sys",
		"aud_a2sys",
		"aud_pcmif",
		"aud_a3sys",
		"aud_a4sys",
		"aud_memif_ul1",
		"aud_memif_ul2",
		"aud_memif_ul3",
		"aud_memif_ul4",
		"aud_memif_ul5",
		"aud_memif_ul6",
		"aud_memif_ul8",
		"aud_memif_ul9",
		"aud_memif_ul10",
		"aud_memif_dl2",
		"aud_memif_dl3",
		"aud_memif_dl6",
		"aud_memif_dl7",
		"aud_memif_dl8",
		"aud_memif_dl10",
		"aud_memif_dl11",
		"aud_gasrc0",
		"aud_gasrc1",
		"aud_gasrc2",
		"aud_gasrc3",
		"aud_gasrc4",
		"aud_gasrc5",
		"aud_gasrc6",
		"aud_gasrc7",
		"aud_gasrc8",
		"aud_gasrc9",
		"aud_gasrc10",
		"aud_gasrc11",
		"aud_gasrc12",
		"aud_gasrc13",
		"aud_gasrc14",
		"aud_gasrc15",
		"aud_gasrc16",
		"aud_gasrc17",
		"aud_gasrc18",
		"aud_gasrc19",
		"aud_src_asrc0",
		"aud_src_asrc1",
		"aud_src_asrc2",
		"aud_src_asrc3",
		"aud_src_asrc4",
		"aud_src_asrc5",
		"aud_src_asrc6",
		"aud_src_asrc7",
		"aud_src_asrc8",
		"aud_src_asrc9",
		"aud_src_asrc10",
		"aud_src_asrc11",
		"peri_ao_ethernet",
		"peri_ao_ethernet_bus",
		"peri_ao_flashif_bus",
		"peri_ao_flashif_flash",
		"peri_ao_ssusb_1p_bus",
		"peri_ao_ssusb_1p_xhci",
		"peri_ao_ssusb_2p_bus",
		"peri_ao_ssusb_2p_xhci",
		"peri_ao_ssusb_3p_bus",
		"peri_ao_ssusb_3p_xhci",
		"peri_ao_spinfi",
		"peri_ao_ethernet_mac",
		"peri_ao_nfi_h",
		"peri_ao_fnfi1x",
		"peri_ao_pcie_p0_mem",
		"peri_ao_pcie_p1_mem",
		"imp_iic_wrap_s_i2c5",
		"imp_iic_wrap_s_i2c6",
		"imp_iic_wrap_s_i2c7",
		"imp_iic_wrap_w_i2c0",
		"imp_iic_wrap_w_i2c1",
		"imp_iic_wrap_w_i2c2",
		"imp_iic_wrap_w_i2c3",
		"imp_iic_wrap_w_i2c4",
		"mfg_bg3d",
		"vpp0_mdp_fg",
		"vpp0_stitch",
		"vpp0_padding",
		"vpp0_mdp_tcc",
		"vpp0_warp0_async_tx",
		"vpp0_warp1_async_tx",
		"vpp0_mutex",
		"vpp0_vpp02vpp1_relay",
		"vpp0_vpp12vpp0_async",
		"vpp0_mmsysram_top",
		"vpp0_mdp_aal",
		"vpp0_mdp_rsz",
		"vpp0_smi_common",
		"vpp0_gals_vdo0_larb0",
		"vpp0_gals_vdo0_larb1",
		"vpp0_gals_vencsys",
		"vpp0_gals_vencsys_core1",
		"vpp0_gals_infra",
		"vpp0_gals_camsys",
		"vpp0_gals_vpp1_larb5",
		"vpp0_gals_vpp1_larb6",
		"vpp0_smi_reorder",
		"vpp0_smi_iommu",
		"vpp0_gals_imgsys_camsys",
		"vpp0_mdp_rdma",
		"vpp0_mdp_wrot",
		"vpp0_gals_emi0_emi1",
		"vpp0_smi_sub_common_reorder",
		"vpp0_smi_rsi",
		"vpp0_smi_common_larb4",
		"vpp0_gals_vdec_vdec_core1",
		"vpp0_gals_vpp1_wpe",
		"vpp0_gals_vdo0_vdo1_vencsys_core1",
		"vpp0_fake_eng",
		"vpp0_mdp_hdr",
		"vpp0_mdp_tdshp",
		"vpp0_mdp_color",
		"vpp0_mdp_ovl",
		"vpp0_warp0_relay",
		"vpp0_warp0_mdp_dl_async",
		"vpp0_warp1_relay",
		"vpp0_warp1_mdp_dl_async",
		"wpe_vpp0",
		"wpe_vpp1",
		"wpe_smi_larb7",
		"wpe_smi_larb8",
		"wpe_event_tx",
		"wpe_smi_larb7_p",
		"wpe_smi_larb8_p",
		"wpe_vpp0_veci",
		"wpe_vpp0_vec2i",
		"wpe_vpp0_vec3i",
		"wpe_vpp0_wpeo",
		"wpe_vpp0_msko",
		"wpe_vpp0_vgen",
		"wpe_vpp0_ext",
		"wpe_vpp0_vfc",
		"wpe_vpp0_cach0_top",
		"wpe_vpp0_cach0_dma",
		"wpe_vpp0_cach1_top",
		"wpe_vpp0_cach1_dma",
		"wpe_vpp0_cach2_top",
		"wpe_vpp0_cach2_dma",
		"wpe_vpp0_cach3_top",
		"wpe_vpp0_cach3_dma",
		"wpe_vpp0_psp",
		"wpe_vpp0_psp2",
		"wpe_vpp0_sync",
		"wpe_vpp0_c24",
		"wpe_vpp0_mdp_crop",
		"wpe_vpp0_isp_crop",
		"wpe_vpp0_top",
		"wpe_vpp1_veci",
		"wpe_vpp1_vec2i",
		"wpe_vpp1_vec3i",
		"wpe_vpp1_wpeo",
		"wpe_vpp1_msko",
		"wpe_vpp1_vgen",
		"wpe_vpp1_ext",
		"wpe_vpp1_vfc",
		"wpe_vpp1_cach0_top",
		"wpe_vpp1_cach0_dma",
		"wpe_vpp1_cach1_top",
		"wpe_vpp1_cach1_dma",
		"wpe_vpp1_cach2_top",
		"wpe_vpp1_cach2_dma",
		"wpe_vpp1_cach3_top",
		"wpe_vpp1_cach3_dma",
		"wpe_vpp1_psp",
		"wpe_vpp1_psp2",
		"wpe_vpp1_sync",
		"wpe_vpp1_c24",
		"wpe_vpp1_mdp_crop",
		"wpe_vpp1_isp_crop",
		"wpe_vpp1_top",
		"vpp1_svpp1_mdp_ovl",
		"vpp1_svpp1_mdp_tcc",
		"vpp1_svpp1_mdp_wrot",
		"vpp1_svpp1_vpp_pad",
		"vpp1_svpp2_mdp_wrot",
		"vpp1_svpp2_vpp_pad",
		"vpp1_svpp3_mdp_wrot",
		"vpp1_svpp3_vpp_pad",
		"vpp1_svpp1_mdp_rdma",
		"vpp1_svpp1_mdp_fg",
		"vpp1_svpp2_mdp_rdma",
		"vpp1_svpp2_mdp_fg",
		"vpp1_svpp3_mdp_rdma",
		"vpp1_svpp3_mdp_fg",
		"vpp1_vpp_split",
		"vpp1_svpp2_vdo0_dl_relay",
		"vpp1_svpp1_mdp_tdshp",
		"vpp1_svpp1_mdp_color",
		"vpp1_svpp3_vdo1_dl_relay",
		"vpp1_svpp2_vpp_merge",
		"vpp1_svpp2_mdp_color",
		"vpp1_vppsys1_gals",
		"vpp1_svpp3_vpp_merge",
		"vpp1_svpp3_mdp_color",
		"vpp1_vppsys1_larb",
		"vpp1_svpp1_mdp_rsz",
		"vpp1_svpp1_mdp_hdr",
		"vpp1_svpp1_mdp_aal",
		"vpp1_svpp2_mdp_hdr",
		"vpp1_svpp2_mdp_aal",
		"vpp1_dl_async",
		"vpp1_larb5_fake_eng",
		"vpp1_svpp3_mdp_hdr",
		"vpp1_svpp3_mdp_aal",
		"vpp1_svpp2_vdo1_dl_relay",
		"vpp1_larb6_fake_eng",
		"vpp1_svpp2_mdp_rsz",
		"vpp1_svpp3_mdp_rsz",
		"vpp1_svpp3_vdo0_dl_relay",
		"vpp1_disp_mutex",
		"vpp1_svpp2_mdp_tdshp",
		"vpp1_svpp3_mdp_tdshp",
		"vpp1_vpp0_dl1_relay",
		"vpp1_hdmi_meta",
		"vpp1_vpp_split_hdmi",
		"vpp1_dgi_in",
		"vpp1_dgi_out",
		"vpp1_vpp_split_dgi",
		"vpp1_vpp0_dl_async",
		"vpp1_vpp0_dl_relay",
		"vpp1_vpp_split_26m",
		"img_larb9",
		"img_traw0",
		"img_traw1",
		"img_traw2",
		"img_traw3",
		"img_dip0",
		"img_wpe0",
		"img_ipe",
		"img_dip1",
		"img_wpe1",
		"img_gals",
		"img1_dip_top_larb10",
		"img1_dip_top_dip_top",
		"img1_dip_nr_reserve",
		"img1_dip_nr_dip_nr",
		"img1_wpe_larb11",
		"img1_wpe_wpe",
		"ipe_dpe",
		"ipe_fdvt",
		"ipe_me",
		"ipe_top",
		"ipe_smi_larb12",
		"cam_larb13",
		"cam_larb14",
		"cam_main_cam",
		"cam_main_camtg",
		"cam_seninf",
		"cam_gcamsva",
		"cam_gcamsvb",
		"cam_gcamsvc",
		"cam_scamsa",
		"cam_scamsb",
		"cam_camsv_top",
		"cam_camsv_cq",
		"cam_adl",
		"cam_asg",
		"cam_pda",
		"cam_fake_eng",
		"cam_main_mraw0",
		"cam_main_mraw1",
		"cam_main_mraw2",
		"cam_main_mraw3",
		"cam_cam2mm0_gals",
		"cam_cam2mm1_gals",
		"cam_cam2sys_gals",
		"cam_rawa_larbx",
		"cam_rawa_cam",
		"cam_rawa_camtg",
		"cam_yuva_larbx",
		"cam_yuva_cam",
		"cam_yuva_camtg",
		"cam_rawb_larbx",
		"cam_rawb_cam",
		"cam_rawb_camtg",
		"cam_yuvb_larbx",
		"cam_yuvb_cam",
		"cam_yuvb_camtg",
		"cam_mraw_larbx",
		"cam_mraw_camtg",
		"cam_mraw_mraw0",
		"cam_mraw_mraw1",
		"cam_mraw_mraw2",
		"cam_mraw_mraw3",
		"ccu_larb18",
		"ccu_ahb",
		"ccu_ccu0",
		"ccu_ccu1",
		"vdec_soc_larb1",
		"vdec_soc_lat",
		"vdec_soc_vdec",
		"vdec_larb1",
		"vdec_lat",
		"vdec_vdec",
		"vdec_core1_larb1",
		"vdec_core1_lat",
		"vdec_core1_vdec",
		"venc_larb",
		"venc_venc",
		"venc_jpgenc",
		"venc_jpgdec",
		"venc_jpgdec_c1",
		"venc_gals",
		"venc_core1_larb",
		"venc_core1_venc",
		"venc_core1_jpgenc",
		"venc_core1_jpgdec",
		"venc_core1_jpgdec_c1",
		"venc_core1_gals",
		"vdo0_disp_ovl0",
		"vdo0_disp_color0",
		"vdo0_disp_color1",
		"vdo0_disp_ccorr0",
		"vdo0_disp_ccorr1",
		"vdo0_disp_aal0",
		"vdo0_disp_aal1",
		"vdo0_disp_gamma0",
		"vdo0_disp_gamma1",
		"vdo0_disp_dither0",
		"vdo0_disp_dither1",
		"vdo0_disp_ovl1",
		"vdo0_disp_wdma0",
		"vdo0_disp_wdma1",
		"vdo0_disp_rdma0",
		"vdo0_disp_rdma1",
		"vdo0_dsi0",
		"vdo0_dsi1",
		"vdo0_dsc_wrap0",
		"vdo0_vpp_merge0",
		"vdo0_dp_intf0",
		"vdo0_disp_mutex0",
		"vdo0_disp_il_rot0",
		"vdo0_apb_bus",
		"vdo0_fake_eng0",
		"vdo0_fake_eng1",
		"vdo0_dl_async0",
		"vdo0_dl_async1",
		"vdo0_dl_async2",
		"vdo0_dl_async3",
		"vdo0_dl_async4",
		"vdo0_disp_monitor0",
		"vdo0_disp_monitor1",
		"vdo0_disp_monitor2",
		"vdo0_disp_monitor3",
		"vdo0_disp_monitor4",
		"vdo0_smi_gals",
		"vdo0_smi_common",
		"vdo0_smi_emi",
		"vdo0_smi_iommu",
		"vdo0_smi_larb",
		"vdo0_smi_rsi",
		"vdo0_dsi0_dsi",
		"vdo0_dsi1_dsi",
		"vdo0_dp_intf0_dp_intf",
		"vdo1_smi_larb2",
		"vdo1_smi_larb3",
		"vdo1_gals",
		"vdo1_fake_eng0",
		"vdo1_fake_eng",
		"vdo1_mdp_rdma0",
		"vdo1_mdp_rdma1",
		"vdo1_mdp_rdma2",
		"vdo1_mdp_rdma3",
		"vdo1_vpp_merge0",
		"vdo1_vpp_merge1",
		"vdo1_vpp_merge2",
		"vdo1_vpp_merge3",
		"vdo1_vpp_merge4",
		"vdo1_vpp2_to_vdo1_dl_async",
		"vdo1_vpp3_to_vdo1_dl_async",
		"vdo1_disp_mutex",
		"vdo1_mdp_rdma4",
		"vdo1_mdp_rdma5",
		"vdo1_mdp_rdma6",
		"vdo1_mdp_rdma7",
		"vdo1_dp_intf0_mm",
		"vdo1_dpi0_mm",
		"vdo1_dpi1_mm",
		"vdo1_disp_monitor",
		"vdo1_merge0_dl_async",
		"vdo1_merge1_dl_async",
		"vdo1_merge2_dl_async",
		"vdo1_merge3_dl_async",
		"vdo1_merge4_dl_async",
		"vdo1_vdo0_dsc_to_vdo1_dl_async",
		"vdo1_vdo0_merge_to_vdo1_dl_async",
		"vdo1_hdr_vdo_fe0",
		"vdo1_hdr_gfx_fe0",
		"vdo1_hdr_vdo_be",
		"vdo1_hdr_vdo_fe1",
		"vdo1_hdr_gfx_fe1",
		"vdo1_disp_mixer",
		"vdo1_hdr_vdo_fe0_dl_async",
		"vdo1_hdr_vdo_fe1_dl_async",
		"vdo1_hdr_gfx_fe0_dl_async",
		"vdo1_hdr_gfx_fe1_dl_async",
		"vdo1_hdr_vdo_be_dl_async",
		"vdo1_dpi0",
		"vdo1_disp_monitor_dpi0",
		"vdo1_dpi1",
		"vdo1_disp_monitor_dpi1",
		"vdo1_dpintf",
		"vdo1_disp_monitor_dpintf",
		"vdo1_26m_slow",
		/* end */
		NULL
	};

	return clks;
}

/*
 * clkdbg pwr_status
 */

static const char * const *get_pwr_names(void)
{
	static const char * const pwr_names[] = {
		[0] = "",
		[1] = "",
		[2] = "",
		[3] = "ETHER",
		[4] = "",
		[5] = "",
		[6] = "",
		[7] = "",
		[8] = "AUDIO",
		[9] = "AUDIO_ASRC",
		[10] = "ADSP",
		[11] = "VPPSYS0",
		[12] = "VPPSYS1",
		[13] = "VDOSYS0",
		[14] = "VDOSYS1",
		[15] = "WPESYS",
		[16] = "DP_TX",
		[17] = "EPD_TX",
		[18] = "HDMI_TX",
		[19] = "HDMI_RX",
		[20] = "VDEC0",
		[21] = "VDEC1",
		[22] = "VDEC2",
		[23] = "VENC",
		[24] = "VENC_CORE1",
		[25] = "CAM",
		[26] = "CAM_RAWA",
		[27] = "CAM_RAWB",
		[28] = "CAM_MRAW",
		[29] = "IMG",
		[30] = "DIP",
		[31] = "IPE",
		/* CPU_PWR_STA */
		[32] = "CPUEB",
		[33] = "MFG0",
		[34] = "MFG1",
		[35] = "MFG2",
		[36] = "MFG3",
		[37] = "MFG4",
		[38] = "MFG5",
		[39] = "MFG6",
		[40] = "IFR",
		[41] = "IFR_SUB",
		[42] = "PERI",
		[43] = "PEXTP_MAC_TOP_P0",
		[44] = "PEXTP_MAC_TOP_P1",
		[45] = "PCIE_PHY",
		[46] = "SSUSB_PCIE_PHY",
		[47] = "NNA0",
		[48] = "NNA1",
		[49] = "IPNNA",
		[50] = "CSI_RX_TOP",
		[51] = "",
		[52] = "",
		[53] = "",
		[54] = "CPU0",
		[55] = "CPU1",
		[56] = "CPU2",
		[57] = "CPU3",
		[58] = "CPU4",
		[59] = "CPU5",
		[60] = "CPU6",
		[61] = "CPU7",
		[62] = "CPUTOP",
		[63] = "MCUSYS",
		[64] = NULL,
	};

	return pwr_names;
}

static u32 _get_pwr_status(u32 pwr_sta_ofs, u32 pwr_sta_2nd_ofs)
{
	static void __iomem *scpsys_base, *pwr_sta, *pwr_sta_2nd;

	scpsys_base = ioremap(0x10006000, PAGE_SIZE);
	pwr_sta = scpsys_base + pwr_sta_ofs;
	pwr_sta_2nd = scpsys_base + pwr_sta_2nd_ofs;

	return clk_readl(pwr_sta) & clk_readl(pwr_sta_2nd);
}

static u32 *get_all_pwr_status(void)
{
	static struct regs {
		u32 pwr_sta_ofs;
		u32 pwr_sta_2nd_ofs;
	} g[] = {
		{0x16c, 0x170},
		{0x174, 0x178},
	};

	static u32 pwr_sta[PWR_STA_GROUP_NR];
	int i;

	for (i = 0; i < PWR_STA_GROUP_NR; i++)
		pwr_sta[i] = _get_pwr_status(g[i].pwr_sta_ofs, g[i].pwr_sta_2nd_ofs);

	return pwr_sta;
}

/*
 * clkdbg dump_clks
 */

static void setup_provider_clk(struct provider_clk *pvdck)
{
	static const struct {
		const char *pvdname;
		u32 pwr_sta_group;
		u32 pwr_mask;
	} pvd_pwr_mask[] = {
		{"nnasys", 1, BIT(17)},
		{"mfgcfg", 1, BIT(2)},
		{"audsys", 0, BIT(8)},
		{"audsys_src", 0, BIT(9)},
		{"vppsys0", 0, BIT(11)},
		{"wpesys", 0, BIT(15)},
		{"wpesys_vpp0", 0, BIT(15)},
		{"wpesys_vpp1", 0, BIT(15)},
		{"vppsys1", 0, BIT(12)},
		{"imgsys", 0, BIT(29)},
		{"imgsys1_dip_top", 0, BIT(30)},
		{"imgsys1_dip_nr", 0, BIT(30)},
		{"imgsys1_wpe", 0, BIT(30)},
		{"ipesys", 0, BIT(31)},
		{"camsys", 0, BIT(25)},
		{"camsys_rawa", 0, BIT(26)},
		{"camsys_yuva", 0, BIT(26)},
		{"camsys_rawb", 0, BIT(27)},
		{"camsys_yuvb", 0, BIT(27)},
		{"camsys_mraw", 0, BIT(28)},
		{"ccusys", 0, BIT(25)},
		{"vdecsys_soc", 0, BIT(20)},
		{"vdecsys", 0, BIT(21)},
		{"vdecsys_core1", 0, BIT(22)},
		{"vencsys", 0, BIT(23)},
		{"vencsys_core1", 0, BIT(24)},
		{"vdosys0", 0, BIT(13)},
		{"vdosys1", 0, BIT(14)},
	};

	static const struct {
		const char *bus_clk_name;
		const char *provider_name;
	} pvd_bus_map[] = {
		{"i2c_sel", "imp_iic_wrap_s"},
		{"i2c_sel", "imp_iic_wrap_w"},
	};

	size_t i;
	const char *pvdname = pvdck->provider_name;

	if (pvdname == NULL)
		return;

	for (i = 0; i < ARRAY_SIZE(pvd_pwr_mask); i++) {
		if (strcmp(pvdname, pvd_pwr_mask[i].pvdname) == 0) {
			pvdck->pwr_sta_group = pvd_pwr_mask[i].pwr_sta_group;
			pvdck->pwr_mask = pvd_pwr_mask[i].pwr_mask;
			return;
		}
	}

	for (i = 0; i < ARRAY_SIZE(pvd_bus_map); i++) {
		if (strcmp(pvdname, pvd_bus_map[i].provider_name) == 0) {
			pvdck->bus_ck = __clk_lookup(pvd_bus_map[i].bus_clk_name);
			return;
		}
	}
}

static struct device_node *get_power_controller(void)
{
	return of_find_compatible_node(NULL, NULL, "mediatek,mt8195-power-controller");
}

/*
 * init functions
 */

static struct clkdbg_ops clkdbg_mt8195_ops = {
	.get_all_fmeter_clks = get_all_fmeter_clks,
	.fmeter_freq = fmeter_freq_op,
	.get_all_regnames = get_all_regnames,
	.get_all_clk_names = get_all_clk_names,
	.get_pwr_names = get_pwr_names,
	.setup_provider_clk = setup_provider_clk,
	.get_all_pwr_status = get_all_pwr_status,
	.get_power_controller = get_power_controller,
};

static void __init init_custom_cmds(void)
{
	static const struct cmd_fn cmds[] = {
		{}
	};

	set_custom_cmds(cmds);
}

static int __init clkdbg_mt8195_init(void)
{
	if (of_machine_is_compatible("mediatek,mt8195") == 0)
		return -ENODEV;

	init_regbase();

	init_custom_cmds();
	set_clkdbg_ops(&clkdbg_mt8195_ops);

#if DUMP_INIT_STATE
	print_regs();
	print_fmeter_all();
#endif /* DUMP_INIT_STATE */

	return 0;
}
device_initcall(clkdbg_mt8195_init);
